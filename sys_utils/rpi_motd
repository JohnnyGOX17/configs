#!/bin/bash
# Set SSH MOTD via cron job (via `$ crontab -e`):
#  0 */4 * * * <this script's location>

motd_file_path='/etc/motd'

# Generated by https://patorjk.com/software/taag/#p=display&f=ANSI%20Shadow&t=RP-DEV
read -r -d '' hello_str << EOM

██████╗ ██████╗       ██████╗ ███████╗██╗   ██╗
██╔══██╗██╔══██╗      ██╔══██╗██╔════╝██║   ██║
██████╔╝██████╔╝█████╗██║  ██║█████╗  ██║   ██║
██╔══██╗██╔═══╝ ╚════╝██║  ██║██╔══╝  ╚██╗ ██╔╝
██║  ██║██║           ██████╔╝███████╗ ╚████╔╝ 
╚═╝  ╚═╝╚═╝           ╚═════╝ ╚══════╝  ╚═══╝  
                                               
EOM
cpu_temp=$(</sys/class/thermal/thermal_zone0/temp)
cpu_temp_str="$((cpu_temp/1000))'C"
gpu_temp_str="$(/usr/bin/vcgencmd measure_temp)"
uptime_str=$(uptime)
num_apt_updates_avail="$(($(/usr/bin/apt list --upgradable | wc -l) - 1 ))"

echo "$hello_str" > $motd_file_path
echo "Uptime: $uptime_str" >> $motd_file_path
echo "CPU temp=$cpu_temp_str | GPU $gpu_temp_str" >> $motd_file_path
if [ "$num_apt_updates_avail" -ge 1 ] ; then 
	printf " \uf31b Apt Updates Available: %s\n" "$num_apt_updates_avail" >> $motd_file_path; 
fi
